\documentclass{amsart}
\usepackage{amsmath,amsfonts,amssymb,amsthm,pb-diagram,stmaryrd,mathrsfs}
\usepackage{tikz-cd}
\usepackage[osf]{baskervillef}
\def\MC{\mathrm{MC}}
\def\ZZ{\mathbb{Z}}
\def\NN{\mathbb{N}}
\def\RR{\mathbb{R}}
\def\EE{\mathbb{E}}
\def\CC{\mathbb{C}}
\def\TT{\mathbb{T}}
\def\XX{\mathscr{X}}
\def\e{\mathsf{e}}
\def\h{\mathsf{h}}
\def\f{\mathsf{f}}
\def\sF{\mathscr{F}}
\def\sT{\mathscr{T}}
\def\sM{\mathscr{M}}
\def\sR{\mathscr{R}}
\def\sS{\mathscr{S}}
\def\fu{\mathfrak{u}}
\def\inv{\tau} % THE involution
\def\comma{,}
\DeclareMathOperator{\Isom}{\mathrm{Isom}}
\DeclareMathOperator{\Aut}{\mathrm{Aut}}
\DeclareMathOperator{\trans}{\mathfrak{trans}}
\DeclareMathOperator{\pr}{\mathrm{pr}}
\DeclareMathOperator{\id}{\mathrm{id}}
\def\O{\mathsf{O}}
\def\SO{\mathsf{SO}}
\DeclareMathOperator{\tail}{{\mathsf{tl}}}
\DeclareMathOperator{\head}{{\mathsf{hd}}}
\DeclareMathOperator{\stail}{{\mathrm{tail}}}
\DeclareMathOperator{\shead}{{\mathrm{head}}}
\DeclareMathOperator{\hor}{\mathsf{hor}}
\DeclareMathOperator{\ver}{\mathsf{ver}}
\DeclareMathOperator{\Hor}{\mathsf{Hor}}
\DeclareMathOperator{\red}{\mathsf{red}}
\def\kin{\mathrm{kin}}
\def\euc{\mathrm{euc}}
\newtheorem{lem}{Lemma}
\newtheorem{prop}{Proposition}
\theoremstyle{definition}
\newtheorem{defn}{Definition}
\begin{document}


\section{Setup}

\subsection{}
Let $\EE^2$ be the Euclidean plane, $\sT \subset \EE^2 \times \EE^2$
the subspace parameterising pairs of points at distance $1$, viewed
as a double fibration via the two projections $p_1,p_2 : \sT \to \EE^2$.
Given an element
$(p,p') \in \sT$, let $S_{(p,p')} : T_p\EE^2 \to T_{p'}\EE^2$
be the linear map sending a tangent vector at $p$ to
its reflection about the line $\overline{pp'}$, translated
to $p'$. These induce a homomorphism 
$$ \sS : p_1^* T\EE^2 \to p_2^* T\EE^2  $$
of vector bundles over $\sT$.

\subsection{}
The configuration space of the infinite snake in $\EE^2$ is
$$ \sM = \sT \times_{\EE^2} \sT \times_{\EE^2} \sT \times \cdots $$
where the fibred products involve $p_2$ from the left factor and $p_1$ from the right factor.
Projection onto the leftmost factor, denoted $$ \shead : \sM \to \sT,$$ 
maps a snake to its \emph{head}.
Composing it with $p_1$ defines the structure map $$\pi : \sM \to \EE^2,$$ mapping
a snake to its \emph{nose}. Finally, projection onto all but the leftmost factor,
defines a map
$$ \stail:\sM \to \sM $$
sending a snake to its \emph{tail}.
Note that we have $p_1\circ\shead\circ\stail = p_2\circ\shead$.

\subsection{}
The kinematics of the snake are encoded in a connection $\nabla^\sM_\kin$
in the fibre bundle $\pi : \sM \to \EE^2$, uniquely defined by the following properties:
\begin{enumerate}
        \item $\stail : \sM \to \sM$ preserves the horizontal distribution $\Hor_\kin^\sM \subset T\sM$,
        \item the following diagram of morphisms of vector bundles over $\sM$ is commutative:
                $$\begin{tikzcd}
                        \Hor_\kin^\sM \arrow[rrr,"\stail_*"] \arrow[d,"\pi_*"] & & & \stail^*\Hor^\sM_\kin 
                                                                               \arrow[d,"\stail^*\pi_*"] \\
                        \shead^* p_1^* T\EE^2 \arrow[rr,"\shead^*\sS"] & & \shead^* p_2^* T\EE^2
                        \arrow[r,equal] & \stail^*\shead^*p_1^*T\EE^2.
                \end{tikzcd}$$
\end{enumerate}
The latter condition means simply that, for an infinitesimal motion
of the snake described by a vector in $\Hor^\sM_\kin$, the infinitesimal
motion of the \emph{nose} and that of the \emph{nose of the tail} are
related by the operation $\sS$ evaluated at the \emph{head}.

\subsection{}
Let $\sF = \Isom(\RR^2,\EE^2)$ be the orthonormal frame bundle of $\EE^2$.
Each $e \in \sF$ is an isometry $\RR^2 \to \EE^2$, and sending $e$ to $e(0)$
defines a structure map $\sF \to \EE^2$. Then $\sF$ beomes a right $\O(2)$-principal bundle,
as well as a left principal homogeneous space for the isometry group $\Aut\EE^2$.
Let $\TT \subset \RR^2$ be the unit circle. The following identifications are immediate:
$$
 \sF \times^{\O(2)} \RR^2 \simeq T\EE^2,\quad
 \sF \times^{\O(2)} \RR^2 \simeq \EE^2 \times \EE^2,\quad
 \sF \times^{\O(2)} \TT \simeq \sT.
$$
\subsection{}
We also introduce the \emph{model} configuration space $M$ of infinite stakes in $\RR^2$ with nose at $0$,
so that we may identify
$$
 \sF \times^{\O(2)} M \simeq \sM.
$$
There is an obvious head map $\head:M \to \TT$ such that
$\sF \times^{\O(2)}\head = \shead$ under the above identifications.

\subsection{}
The flat Euclidean connection $\nabla^\sF_\euc$ in $\sF$
defines a connection $\nabla^\sM_\euc$ on $\sM=\sF\times^{\O(2)}M$.
Given a vector $v \in T_p\EE^2$, the difference between its horizontal
lifts by $\nabla^\sM_\kin$ and $\nabla^\sM_\euc$ is a vector field
on the fibre $\sM_p$. In terms of associated bundles, this defines a map
$$ \widetilde\xi : T\EE^2 \simeq \sF\times^{\O(2)}\RR^2 \to \sF \times^{\O(2)}\XX(M). $$
We will use the same symbol to denote the associated evaluation map $T\EE^2\times_{\EE^2}\sM
\to V\sM$, where $V\sM = \ker \pi_*  \subset T\sM$.
\begin{lem}\label{lem:recur-tildes-cd}
There is a commutative diargam
$$\begin{tikzcd}
        &V\sM \arrow[r,"\ver^\sM_\euc\circ T\stail"] & V\sM 
        \\ 
        T\EE^2\times_{\EE^2}\sM 
        \arrow[ur,"\widetilde\xi"]
        \arrow[dr,"\id\times\shead"]
        \arrow[rrr,dashed,"\textrm{ind. by}\ \sS\comma\ \stail"]
        & & & T\EE^2\times_{\EE^2}\sM 
        \arrow[ul,"\widetilde\xi"]
        \arrow[dl,"\pr"]
        \\
                  &T{\EE^2}\times_{\EE^2}\sT \arrow[r,"\pr\circ\sS"]  & T\EE^2 
\end{tikzcd}$$
where $\pr$ denotes a canonical projection, 
and $\ver^\sM_\euc : T\sM \to V\sM$ is the vertical projection
defined by $\nabla^\sM_\euc$.
\end{lem}
\begin{proof}
        This follows from the defining properties of $\nabla^\sM_\kin$.
\end{proof}

\subsection{}
Since $\widetilde\xi$ is by construction invariant under the left action of $\Aut\EE^2$,
it necessarily arises as $\widetilde\xi = \sF\times^{\O(2)}\xi$ from an $\O(2)$-equivariant map
$$ \xi : \RR^2 \to \XX(M). $$
Our aim is to study $\xi$ and the Lie algebra generated by its image.
Since $\nabla^\sM_\kin$ is determined corecursively by its relation to $\stail : \sM \to \sM$,
it is natural to seek a corecursive expression for $\xi$ in relation to an analogous map $\tail:M \to M$.
There are many ways to define the latter. 
The one distinguished by the flat Euclidean structure of $\EE^2$
does not lead to the simplest recursion relations; it pays off to introduce an appropriate gauge twist in $\sF$.

\subsection{}
To define the tail of a model configuration  $m \in M$, 
we use some frame $e \in \sF$ to map $m$ into $\EE^2$,
apply $\stail$ there, and use another frame $e' \in \sF$ at
the new nose to read off $\tail m\in M$. This implies a map 
\begin{equation}\label{eq:eme'}\sF \times M \to \sF,\quad (e,m) \mapsto e'.\end{equation}
The result, $\tail m$, should not depend on the choice of $e$,
whence the above map is required to be equivariant under the
left action of $\Aut\EE^2$. Furthermore, we will only use $\head m \in \TT$
to define $e'$. 
That is, we construct a diagram of the form:
$$\begin{tikzcd}
        \sF\times^{\O(2)}M \arrow[d,"\stail" left] & \sF\times M \arrow[l] \arrow[r,"\pr_2"]
        \arrow[d,"\langle\Phi\circ(\id\times\head)\comma" left,"\tail\circ\pr_2\rangle" right]
                                              & M \arrow[d,"\tail"] \\
        \sF\times^{\O(2)}M & \sF\times M \arrow[l] \arrow[r,"\pr_2"] & M
\end{tikzcd}$$
with a suitable $\Aut\EE^2$-equivariant map $$\Phi : \sF\times \TT \to \sF.$$
It then follows that $\Phi$ is given by $\Phi(e,u)=e\varphi(u) + e(u)$ for
some $\varphi : \TT \to \O(2)$. We choose
$$ \varphi(u) = S_uR_u = R_u S_{\epsilon_1}$$
where $\epsilon_1,\epsilon_2 \in \RR^2$ is the standard orthonormal basis,
$S_u$ is the reflection abount the line spanned by $u$, and $R_u$ the rotation
mapping $\epsilon_1$ to $u$. Thus $\varphi$ is an $\SO(2)$-equivariant 
map of the circle onto the odd component of $\O(2)$.   


\subsection{}
The above choice of $\varphi$ defines $\Phi$ and thus in turn $\tail : M \to M$.
Now, the map
$$ \langle \head,\tail\rangle : M \to \TT \times M $$
is an isomorphism, expressing $M$ coinductively as an infinite-dimensional torus (of course there are as many such presentations, as cofiltration preserving automorphisms of $\TT^\infty$).


\subsection{}
Let us write $\Phi^M : \sF\times M \to \sF$ for
the composite of $\Phi$ with $\id_\sF \times\head$.
Similarly, write $\Phi^{TM} : \sF \times TM \to \sF$ for
the composite of $\Phi^M$ with $\pr_M:TM\to M$.
Consider the maps 
$$ \delta : \sF \times TM \xrightarrow{\ver^\sF_\euc\circ T\Phi^M} V\sF \simeq \sF \times \mathfrak{so}(2) $$
and 
$$ \Psi : \sF \times TM \xrightarrow{\langle \delta, \pr_M\rangle} \sF \times \mathfrak{so}(2) \times M
\xrightarrow{\id_\sF \times \alpha} \sF \times TM $$
where $\alpha : \mathfrak{so}(2) \to \XX(M)$ is the infinitesimal action of $\O(2)$ on $M$.
\begin{lem}\label{lem:ttail}
The following diagram commutes:
$$\begin{tikzcd}
 \sF\times TM \arrow[d] \arrow[rrrr, "\langle\Phi^{TM}\comma T\tail\rangle - \Psi"] 
 & & & & \sF\times TM \arrow[d]\\
        \sF \times^{\O(2)}TM \arrow[r,equal] & V\sM \arrow[rr,"\ver^\sM_\euc\circ T\stail"] & & V\sM
        \arrow[r,equal] & \sF\times^{\O(2)}TM.
\end{tikzcd}$$\end{lem}
\subsection{}
Let us extend $\Phi$ to a map
$$ \widetilde\Phi : \sF \times \RR^2\times \TT \to \sF \times \RR^2 $$
such that 
$\widetilde\Phi(e,v,u) = (e',v')$ with $e'=\Phi(e,u)$ 
and $$e'(v') = T_{e(u)*} e(S_u v),$$ where $T_{e(u)} : \EE^2 \to \EE^2$
denotes Euclidean translation by $e(u)$. Explicitly:
$$ v' = (e \varphi(u))^{-1} e(S_u v) = R_u^{-1}v $$
so that 
$$ \widetilde\Phi(e,v,u) = (e\varphi(u)+e(u), R_u^{-1}v). $$
Now, by construction, $\widetilde\Phi$ descends to a map
$$ 
p_1^*T\EE^2
\simeq  
\sF\times^{\O(2)} (\RR^2\times\TT) 
\to 
\sF\times^{\O(2)}\RR^2 
\simeq 
T\EE^2 
$$ 
coinciding with $$p_1^*T\EE^2 \xrightarrow{\sS}p_2^*T\EE^2 \xrightarrow{\pr} T\EE^2$$
where $p_1,p_2:\sT \to \EE^2$ are the two projections.
We'll use the notation $$\widetilde\Phi^M : \sF\times\RR^2\times M \to \sF\times\RR^2$$
for the composite of $\widetilde\Phi$ with $\id\times\head$.
\subsection{}
We have defined frame analogues of the tail map, namely $\tail$,
and of $\sS$, namely $\widetilde\Phi$.  Thus, we should be able to
express the map $\xi : \RR^2 \to \XX(M)$, a `connection form' of $\nabla^\sM_\kin$.
That is, we seek the frame analogue of Lemma \ref{lem:recur-tildes-cd} and its commutative diagram.
\begin{lem}\label{lem:recur-cd}
        The following diagram commutes and descends to to that of Lemma \ref{lem:recur-tildes-cd}:
$$\begin{tikzcd}
        &\sF\times TM \arrow[r,"\langle\Phi^{TM}\comma T\tail\rangle - \Psi"] & \sF\times TM
        \\ 
        \sF \times \RR^2 \times M
        \arrow[ur,"\id\times \xi"]
        \arrow[dr,"\id\times\shead"]
        \arrow[rrr,"\langle\widetilde\Phi^M\comma\tail\rangle"]
        & & & \sF\times \RR^2\times M
        \arrow[ul,"\id\times\xi"]
        \arrow[dl,"\pr"]
        \\
                  &\sF\times\RR^2\times\TT \arrow[r,"\widetilde\Phi"]  & \sF\times\RR^2.
\end{tikzcd}$$\end{lem}
\begin{proof}
        We use Lemmas \ref{lem:recur-tildes-cd} and \ref{lem:ttail}.
\end{proof}

\subsection{}Let $\omega \in \SO(2)$ be the rotation taking $\epsilon_1$ to $\epsilon_2$.
Consider the vector field 
$$ r \in \XX(\TT),\quad r_u = \omega u $$
and the map
$$ f : \RR^2 \to C^\infty(\TT),\quad f_v(u)= \langle u, \omega v\rangle.$$
Introduce Lie algebra homomorphisms 
$$
\iota_{\head} : \XX(\TT) \to \XX(M),\quad \iota_{\tail} : \XX(M) \to \XX(M)
$$
associated with the isomorphism
$$ \langle \head,\tail \rangle : M \xrightarrow{\sim} \TT \times M. $$
The image of $\iota_{\head}$ annihilates that of $\tail^* :C^\infty(M) \to C^\infty(M)$,
and the image of $\iota_{\tail}$ annihilates that of $\head^* : C^\infty(\TT) \to C^\infty(M)$.
Let us also use the notation
$$ R : \TT \to \SO(2),\quad u\mapsto R_u $$
with matrix elements ${R^i}_{j} \in C^\infty(\TT)$.
\begin{prop}
The map $\xi : \RR^2 \to \XX(M)$ satisfies the following relation:
$$
\xi(v) = \iota_{\head} (f_v r) + (\head^* f_v) \iota_{\tail} (\iota_{\head} r)
+ (\head^* \otimes \iota_{\tail}\xi) (R^{-1}\otimes v)
 $$
 where notation used in the last term stands for
$\sum v^j (\head^*{R_j}^i) \iota_{\tail} \xi(\epsilon_i)$
when written in indices.
\end{prop}
\begin{proof}
        We use Lemma \ref{lem:recur-cd}.
\end{proof}

\section{Recursion relation}
\subsection{}
Head frame $e$, neck frame $e'$. Head drag $ev$, neck drag $e'v'$:
$$ e'v'= e S_\phi v,\quad e^{-1}e' = S_\phi R_\phi \implies v' = R_{\phi}^{-1}v. $$
Drag-to-motion map $\xi$ (head in frame $e$, neck in frame $e'$):
$$ \xi(v) = f_v(\phi)\partial_\phi + f_v(\phi)\sigma\partial_\phi + \sigma \xi(v') $$
$$ \xi(v) = f_v(\phi)\partial_\phi + f_v(\phi)\sigma\partial_\phi + (1\otimes\sigma\xi)(R_\phi^{-1}\otimes v) $$
where
$$ f_v(\phi) = v_x\sin\phi - v_y\cos\phi.$$
\subsection{}
Complexification and variable change:
$$ z = e^{i\phi},\quad \partial_\phi = iz\partial_z,\quad v^\pm = \epsilon_x \pm i\epsilon_y $$
$$ f_{v^\pm} = \mp i z^{\pm 1},\quad
R_\phi^{-1} \otimes v^{\pm} = z^{\pm 1} \otimes v^{\pm}.$$
Motion basis:
$$ \zeta^+ = \xi(v^+) = z^2\partial_z + z \sigma (z\partial_z) + (1\otimes \sigma\xi)(z\otimes v^+)
= z^2\partial_z + z\sigma(z\partial_z + \zeta^+) $$
$$ \zeta^- = \xi(v^-) =- \partial_z + z^{-1}\sigma(-z\partial z) + (1\otimes\sigma\xi)(z^{-1}\otimes v^-)
= -\partial_z + z^{-1}\sigma(-z\partial_z + \zeta^-). $$
\subsection{}
With $\mathfrak{sl}_2$ notation ($\h$ being half the usual one):
$$ \e = z^2\partial_z,\quad \h = z\partial z,\quad \f = \partial_z $$
$$\zeta^+ = \e + z\sigma(\h + \zeta^+),\quad \zeta^- = -\f + z^{-1}\sigma(-\h + \zeta^-)$$
Involution:
$$ \sigma^\inv=\sigma,\qquad z^\inv = z^{-1},\quad \e^\inv=-\f,\quad \h^\inv=-\h,\quad \f^\inv=-\e,
\qquad
\left(\zeta^{\pm}\right)^\inv=\zeta^\mp $$

\end{document}
